{% load static %}
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}VPP Shop - Văn Phòng Phẩm Chính Hãng{% endblock %}</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <link rel="stylesheet" href="{% static 'css/common.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    {% block extra_css %}{% endblock %}
</head>
<body>
    <header>
        <div class="top-header">
        <div class="container top-header-content">
            <div class="logo">
                <a href="{% url 'web:home' %}">
                    <img src="{% static 'img/vpp_shop_logo.png' %}" alt="VPP Shop Logo" class="logo-img">
                </a>
            </div>
            
            <div class="search-bar">
                <form action="{% url 'web:home' %}" method="GET">
                    <input type="text" 
                           placeholder="Tìm kiếm sản phẩm..." 
                           name="q" 
                           value="{{ query|default:'' }}">
                    <button type="submit"><i class="fas fa-search"></i></button> 
                </form>
            </div>

            <div class="contact-info">
                <div class="contact-item hotline-item"> 
                    <i class="fas fa-phone-volume"></i> 
                    <div class="hotline-text">
                        <p>0123456789</p>
                        <span>Liên hệ</span>
                    </div>
                </div>
                
                <div class="contact-item user-item"> 
                    <i class="fas fa-user"></i> 
                    <div class="user-text">
                        {% if request.session.khach_hang_id %}
                            <span class="d-block fw-bold" style="font-size: 0.9rem; color: #fff;">
                                Xin chào, {{ request.session.khach_hang_ten }}
                            </span>
                            <div class="d-flex gap-2">
                                <a href="{% url 'web:profile_info' %}" style="font-size: 0.8rem;">Tài khoản</a>
                                <span style="color: #ccc;">|</span>
                                <a href="{% url 'web:logout' %}" style="font-size: 0.8rem; color: #ffc107;">Đăng xuất</a>
                            </div>
                        {% else %}
                            <a href="{% url 'web:login' %}?next={{ request.path }}">Đăng nhập</a>
                            <a href="{% url 'web:register' %}">Đăng ký</a>
                        {% endif %}
                    </div>
                </div>

                <div class="contact-item cart-item"> 
                    <a href="{% url 'web:view_cart' %}"> <i class="fas fa-shopping-cart"></i>
                    </a> 
                    
                    <span class="cart-count" style="color: white;">
                        {{ cart_count }}
                    </span>
                </div>
            </div>
        </div>
    </div>

        <nav class="main-nav-bar">
            <div class="container">
                <ul>
                    {% if danh_muc_menu %}
                        {% for dm in danh_muc_menu %}
                            <li>
                                <a href="{% url 'web:category_detail' dm.id %}">{{ dm.TenDanhMuc }}</a>
                            </li>
                        {% endfor %}
                    {% else %}
                        <li><a href="#">Bút Viết</a></li>
                        <li><a href="#">Văn phòng phẩm</a></li>
                        <li><a href="#">Dụng Cụ Học Tập</a></li>
                    {% endif %}
                </ul>
            </div>
        </nav>
    </header>

    <main>
        
        {% block content %}
        {% endblock %}
    </main>
    {% if messages %}
    <div id="toast-container" style="position: fixed; top: 100px; right: 20px; z-index: 9999; min-width: 300px;">
        {% for message in messages %}
            <div class="alert alert-{% if message.tags == 'error' %}danger{% else %}{{ message.tags }}{% endif %} alert-dismissible fade show shadow-lg border-0" role="alert" style="opacity: 0.95;">
                <div class="d-flex align-items-center">
                    {% if message.tags == 'success' %}
                        <i class="fas fa-check-circle me-2 text-success fs-4"></i>
                    {% elif message.tags == 'error' %}
                        <i class="fas fa-exclamation-circle me-2 text-danger fs-4"></i>
                    {% else %}
                        <i class="fas fa-info-circle me-2 text-info fs-4"></i>
                    {% endif %}
                    
                    <strong>{{ message }}</strong>
                </div>
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        {% endfor %}
    </div>

    <script>
        setTimeout(function() {
            let alerts = document.querySelectorAll('.alert');
            alerts.forEach(function(alert) {
                // Dùng Bootstrap API để đóng alert (nếu có dùng bootstrap js)
                // Hoặc dùng CSS thuần:
                alert.style.transition = "opacity 0.5s ease";
                alert.style.opacity = "0";
                setTimeout(() => alert.remove(), 500);
            });
        }, 4000); // 4000ms = 4 giây
    </script>
    {% endif %}
    <footer>
        <div class="footer-main">
            <div class="container footer-grid">
                <div class="footer-col intro-col">
                    <img src="{% static 'img/vpp_shop_logo.png' %}" alt="VPP Shop Logo" class="footer-logo">
                    <p>Website thương mại điện tử trực thuộc VPP Shop Việt Nam.</p>
                    <div class="subscribe-form">
                        <input type="email" placeholder="Đăng ký nhận tin">
                        <button>Đăng ký</button>
                    </div>
                </div>

                <div class="footer-col address-col">
                    <h4>ĐỊA CHỈ CÔNG TY</h4>
                    <p>Bắc Từ Liêm District, Hà Nội</p>
                </div>

                <div class="footer-col support-col">
                    <h4>HỖ TRỢ KHÁCH HÀNG</h4>
                    <p class="hotline-footer">Hotline: <span>0123456789</span></p>
                    <p>Sales/Online (8h - 17h)</p>
                    <ul class="list-footer">
                        <li><a href="#">Hướng dẫn mua hàng</a></li>
                        <li><a href="#">Hướng dẫn thanh toán</a></li>
                        <li><a href="#">Chính sách giao hàng</a></li>
                        <li><a href="#">Chính sách đổi trả & hoàn tiền</a></li>
                    </ul>
                </div>

                <div class="footer-col about-col">
                    <h4>VỀ VPP SHOP</h4>
                    <ul class="list-footer">
                        <li><a href="#">Giới thiệu VPP Shop</a></li>
                        <li><a href="#">Chính sách bảo mật chung</a></li>
                        <li><a href="#">Chính sách bảo mật thông tin cá nhân</a></li>
                        <li><a href="#">Thông tin liên hệ</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    {% block extra_js %}{% endblock %}

</body>
</html>